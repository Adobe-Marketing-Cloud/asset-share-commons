<!--/*
  ~ Asset Share Commons
  ~
  ~ Copyright [2017]  Adobe
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
 */-->

<sly
	data-sly-use.modelCache="com.adobe.aem.commons.assetshare.util.ModelCache"
	data-sly-test.config="${modelCache['com.adobe.aem.commons.assetshare.configuration.Config']}"
	data-sly-use.downloadsPanel="com.adobe.aem.commons.assetshare.components.actions.downloadspanel.DownloadsPanel"
	data-sly-use.placeholderTemplate="core/wcm/components/commons/v1/templates.html"></sly>

<style data-sly-test="${!wccmode.disabled}">
.cmp-modal-downloads-panel .ui.modal {
	position: relative !important;
	display: block !important;
	top: 0 !important;
}
</style>
<div id="downloads-panel"
		data-asset-share-id="downloadspanel-modal"
		data-asset-share-status="${downloadsPanel.status}"
		data-asset-share-update-method="replace"
		data-asset-share-update-when="downloads-update"
		class="ui long modal cmp-modal-downloadPanel--wrapper cmp-modal">

	<i class="close icon"></i>
	<div class="header">
		TESTING
		${properties['modalTitle']}
		<span
			data-sly-test="${downloadsPanel.downloads.size > 0}"
			class="right-align"
			data-asset-share-id="refresh-downloads">
				<a href="#refresh">Refresh</a>
		</span>
		<span class="right-align"
			  data-asset-share-id="clear-downloads">
			<a href="">${properties['clear']}</a>
		</span>
	</div>

	<div class="cmp-content scrolling content">
		<div id="FileDownloadsPanelModal" class="downloadsPanelModal">
			<div class="modal-content">
				<div id="downloadsPanel" class="container">
					<div class="ui container">


			<div data-sly-list.dp="${downloadsPanel.downloads}">
				<div>User: ${dp.requestingUser}</div>
				<div>Total Count: ${dp.totalCount}</div>
				<div>Processed Count: ${dp.processedCount}</div>
				<div>Failure Count: ${dp.failureCount}</div>
				<div>Success Count: ${dp.successCount}</div>
				<div>Complete?: ${dp.complete.time}</div>
				<div>Started: ${dp.started.time}</div>
				<div>Finished: ${dp.finished.time}</div>


				<!--/* Start download record */-->

				<div data-sly-list.da="${dp.artifacts}">

					<ul>
						<li>Id: ${da.id}</li>
						<li>Name: ${da.name}</li>
						<li>mimeType: ${da.mimeType}</li>
						<li>Link: <a href="${da.binaryURI.toString}">${da.binaryURI.toString}</a></li>
						<li>Failure reason: ${da.failureReason}</li>
						<li>Successes:
							<ul data-sly-list.s="${da.successes}">
								<li>${s}</li>
							</ul>
						</li>
						<li> Failures:
							<ul data-sly-list.failure="${da.failures}">
								<li>${failure} : ${da.failures[failure]}</li>
							</ul>
						</li>
					</ul>
				</div>

				<!--/* End download record */-->

			</div>





			<p data-sly-test="${downloadsPanel.downloadProgress.size == 0}">${properties['noContentMessage']}</p>
		</div>
	</div>
	<script>
		$('.ui.accordion').accordion();
	</script>
</div>