<!--/*
  ~ Asset Share Commons
  ~
  ~ Copyright [2017]  Adobe
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
 */-->

<sly
	data-sly-use.modelCache="com.adobe.aem.commons.assetshare.util.ModelCache"
	data-sly-test.config="${modelCache['com.adobe.aem.commons.assetshare.configuration.Config']}"
	data-sly-use.downloadsPanel="com.adobe.aem.commons.assetshare.components.actions.downloadspanel.DownloadsPanel"
	data-sly-use.placeholderTemplate="core/wcm/components/commons/v1/templates.html"></sly>

<style data-sly-test="${!wccmode.disabled}">
.cmp-modal-downloads-panel .ui.modal {
	position: relative !important;
	display: block !important;
	top: 0 !important;
}
</style>
<div id="downloads-panel"
		data-asset-share-id="downloadspanel-modal"
		data-asset-share-status="${downloadsPanel.status}"
		data-asset-share-update-method="replace"
		data-asset-share-update-when="downloads-update"
		class="ui long modal cmp-modal-downloadPanel--wrapper cmp-modal">

	<i class="close icon"></i>
	<div class="header">
		${properties['modalTitle']}
		<span
			data-sly-test="${downloadsPanel.downloads.size > 0}"
			class="right-align"
			data-asset-share-id="refresh-downloads">
				<a href="#refresh">Refresh</a>
		</span>
		<span class="right-align"
			  data-asset-share-id="clear-downloads">
			<a href="">${properties['clear']}</a>
		</span>
	</div>

	<div class="cmp-content scrolling content">
		<div id="FileDownloadsPanelModal" class="downloadsPanelModal">
			<div class="modal-content">
				<div id="downloadsPanel" class="container">
					<div class="ui container">
						<div class="ui styled accordion" style="width: 100%;"
							data-sly-test="${downloadsPanel.downloads.size > 0}">
							<div
								data-sly-list.downloadProgress="${downloadsPanel.downloads}">
								<div class="title">
									<i class="file archive icon"></i>
										${downloadProgress.name}
										<span class="right-align">${properties['progress']}: ${downloadProgress.progress}%</span>
								</div>
								<div>
									<div class="content">
										<div id="${downloadStatus.downloadId}"
											data-asset-share-id="download-archive"
											data-sly-test="${downloadStatus.status == 'SUCCESSFUL'}">

											<a href="${downloadStatus.url}">${properties['downloadZip']}</a>
											<br>
											${properties['fileSize']}: ${downloadProgress.size}
										</div>

										${properties['assetsCount']}: ${downloadProgress.totalCount}<br>
										${properties['status']}: ${downloadProgress.status}<br>

										<div class="accordion">
											<div class=" title">
												<i class="dropdown icon"></i> ${properties['assetListTitle']}
											</div>
											<div class=" content">
												<div class="ui ordered list"
													data-sly-list.downloadedAsset="${downloadProgress.assets}">
													<div class="item ">
														<p>
															${downloadedAsset}
														</p>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<p data-sly-test="${downloadsPanel.downloadProgress.size == 0}">${properties['noContentMessage']}</p>
		</div>
	</div>
	<script>
		$('.ui.accordion').accordion();
	</script>
</div>