<!--/*
  ~ Asset Share Commons
  ~
  ~ Copyright [2017]  Adobe
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
 */-->

<sly
	data-sly-use.modelCache="com.adobe.aem.commons.assetshare.util.ModelCache"
	data-sly-test.config="${modelCache['com.adobe.aem.commons.assetshare.configuration.Config']}"
	data-sly-use.downloadsPanel="com.adobe.aem.commons.assetshare.components.actions.downloadspanel.DownloadsPanel"
	data-sly-use.placeholderTemplate="core/wcm/components/commons/v1/templates.html"></sly>

<style data-sly-test="${!wccmode.disabled}">
.cmp-modal-downloads-panel .ui.modal {
	position: relative !important;
	display: block !important;;
	top: 0 !important;;
}
</style>
<div data-asset-share-id="downloadspanel-modal" id="downloads-panel"
	data-asset-share-status="${downloadsPanel.status}"
	data-asset-share-update-method="replace"
	data-asset-share-update-when="downloads-update"
	class="ui long modal cmp-modal-downloadPanel--wrapper cmp-modal">
	<i class="close icon"></i>
	<div class="header">
		${properties['modalTitle']} <span
			data-sly-test="${downloadsPanel.downloadStatus.size > 0}"
			class="right-align" data-asset-share-id="refresh-downloads"> <a
			href="">Refresh</a>
		</span> <span class="right-align" data-asset-share-id="clear-downloads">
			<a href="">${properties['clear']}</a>
		</span>

	</div>
	<div class="cmp-content scrolling content">
		<!-- The Modal -->
		<div id="FileDownloadsPanelModal" class="downloadsPanelModal">
			<!-- Modal content -->
			<div class="modal-content">
				<div id="downloadsPanel" class="container">
					<!--<span class="close">&times;</span>-->
					<div class="ui container">
						<div class="ui styled accordion" style="width: 100%;"
							data-sly-test="${downloadsPanel.downloadStatus.size > 0}">
							<div
								data-sly-list.downloadStatus="${downloadsPanel.downloadStatus}">
								<div class="title">
									<i class="file archive icon"></i> ${downloadStatus.name} <span
										class="right-align"> ${properties['progress']} -
										${downloadStatus.progress}% </span>
								</div>
								<div>
									<div class="content">

										<div data-asset-share-id="download-archive"
											id="${downloadStatus.downloadId}"
											data-sly-test="${downloadStatus.status == 'SUCCESSFUL'}">
											<a href="${downloadStatus.url}">
												${properties['downloadZip']}</a><br>
											${properties['fileSize']}: ${downloadStatus.size}<br>
										</div>
										${properties['assetsCount']}: ${downloadStatus.totalCount}<br>
										${properties['status']}: ${downloadStatus.status}<br>
										<div class="accordion">
											<div class=" title">
												<i class="dropdown icon"></i>
												${properties['assetListTitle']}
											</div>
											<div class=" content">
												<div class="ui ordered list"
													data-sly-list.downloadedAsset="${downloadStatus.assets}">
													<div class="item ">
														<p>
															${downloadedAsset}<br>
														</p>
													</div>
												</div>
											</div>
										</div>

									</div>
								</div>

							</div>
						</div>
					</div>
				</div>
			</div>
			<p data-sly-test="${downloadsPanel.downloadStatus.size == 0}">
				${properties['noContentMessage']}</p>
		</div>
	</div>
	<script>
		$('.ui.accordion').accordion();
	</script>
</div>