<!--/*
  ~ Asset Share Commons
  ~
  ~ Copyright [2017]  Adobe
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
 */-->

<sly
	data-sly-use.modelCache="com.adobe.aem.commons.assetshare.util.ModelCache"
	data-sly-test.config="${modelCache['com.adobe.aem.commons.assetshare.configuration.Config']}"
	data-sly-use.downloadsPanel="com.adobe.aem.commons.assetshare.components.actions.downloadspanel.DownloadsPanel"
	data-sly-use.downloadTemplate="templates/download.html"
	data-sly-use.placeholderTemplate="core/wcm/components/commons/v1/templates.html"></sly>

<style data-sly-test="${!wccmode.disabled}">
.cmp-modal-downloads-panel .ui.modal {
	position: relative !important;
	display: block !important;
	top: 0 !important;
}
</style>
<div id="downloads-panel"
		data-asset-share-id="downloadspanel-modal"
		data-asset-share-status="${downloadsPanel.status}"
		data-asset-share-update-method="replace"
		data-asset-share-update-when="downloads-update"
		class="ui long modal cmp-modal-downloadPanel--wrapper cmp-modal">

	<i class="close icon"></i>
	<div class="header">
		${properties['modalTitle'] || 'Downloads' @i18n}
		<span
			data-sly-test="${downloadsPanel.downloadProgresses.size > 0}"
			data-asset-share-id="refresh-downloads">
				<a href="#refresh"><i class="refresh sync alternate icon"></i></a>
		</span>
		<span
			  data-asset-share-id="clear-downloads">
			<a href="">${properties['clear']}</a>
		</span>
	</div>

	<div class="cmp-content scrolling content">
		<div id="FileDownloadsPanelModal"
			 class="downloadsPanelModal">
			<div class="modal-content">
				<div id="downloadsPanel" class="container">
					<div class="ui container">


						<table>
							<thead>
								<tr>
									<th class="archive-name">Download file</th>
									<th class="status">Status</th>
									<th class="total-count">No. of assets</th>
									<th class="file-size">File size</th>
									<th class="action"></th>
								</tr>
							</thead>
							<sly data-sly-list.downloadProgress="${downloadsPanel.downloadProgresses}">
								<sly data-sly-call="${downloadTemplate.download @ downloadProgress = downloadProgress}"></sly>
							</sly>
						</table>

					</div>
				</div>
			</div>

			<p data-sly-test="${downloadsPanel.downloadProgresses.size == 0}">${properties['noContentMessage']}</p>
		</div>
	</div>
	<script>
	if (typeof $ !== 'undefined') {
		if (typeof $('#downloads-panel .ui.accordion').accordion !== 'undefined') {
    		$('#downloads-panel .ui.accordion').accordion();
    	}
    }
	</script>
</div>